<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Test: ¿Qué ser espiritual eres? — Botones</title>
<style>
  :root{
    --bg:#0b0b0f; --card:#0f1724; --accent:#ffd27f; --muted:#93a0b0; --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); color:#eef2ff; margin:18px; padding:18px; line-height:1.5;}
  h1{color:var(--accent); margin-bottom:6px}
  p.lead{color:var(--muted); margin-top:0; margin-bottom:18px}
  .quiz{max-width:900px;margin:0 auto}
  .question{background:linear-gradient(180deg,var(--glass), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); padding:16px; border-radius:12px; margin-bottom:12px; transition:all 420ms cubic-bezier(.2,.9,.25,1); overflow:hidden;}
  .q-head{display:flex; align-items:center; gap:12px}
  .q-num{background:rgba(255,255,255,0.03); color:var(--accent); padding:6px 10px; border-radius:8px; font-weight:700}
  .q-text{font-weight:700}
  .choices{display:flex; flex-direction:column; gap:8px; margin-top:12px}
  button.choice{
    text-align:left; background:transparent; border:1px solid rgba(255,255,255,0.04); color:inherit; padding:12px 14px; border-radius:10px; cursor:pointer; transition:all 260ms ease;
  }
  button.choice:hover{transform:translateY(-4px); box-shadow:0 6px 20px rgba(0,0,0,0.6)}
  button.choice[aria-pressed="true"]{background:linear-gradient(90deg, rgba(255,210,127,0.12), rgba(255,210,127,0.06)); border-color:rgba(255,210,127,0.28)}
  .question.answered{max-height:64px; padding-bottom:10px; opacity:0.95}
  .question.answered .choices{display:none}
  .mini{font-size:0.92rem; color:var(--muted); margin-top:8px}
  .controls{display:flex; gap:8px; margin-top:10px}
  .btn-primary{background:var(--accent); color:#0b0b0f; border:none; padding:10px 14px; border-radius:9px; font-weight:700; cursor:pointer}
  .btn-ghost{background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03); padding:8px 12px; border-radius:8px; cursor:pointer}
  .result{background:#071428; border:1px solid rgba(255,255,255,0.04); padding:16px; border-radius:12px; margin-top:18px}
  .muted{color:var(--muted)}
  @media (prefers-reduced-motion:reduce){ *{transition:none!important} }
</style>
</head>
<body>
  <div class="quiz" role="application" aria-label="Test espiritual">
    <h1>Test: ¿Qué ser espiritual eres?</h1>
    <p class="lead">Responde con la primera opción que sientas. Las respuestas se seleccionan con botones; al elegir una, la pregunta se compactará y el test avanza.</p>

    <div id="questions"></div>

    <div class="controls" style="justify-content:space-between; align-items:center;">
      <div class="muted small">Progreso: <span id="progress">0</span>/<span id="total">0</span></div>
      <div>
        <button id="reset" class="btn-ghost">Reset</button>
        <button id="reveal" class="btn-primary">Revelar mi ser espiritual</button>
      </div>
    </div>

    <div id="output" class="result" aria-live="polite" style="display:none"></div>
    <p class="muted small" style="margin-top:12px">Creado por: investigador angelológico con hiperfoco.</p>
  </div>

<script>
// Questions array (editable)
const QUESTIONS = [
  {id:"q1", text:"Cuando enfrentas una decisión moral, tú:", choices:[
    {t:"Sigues el deber y el orden (lo correcto ante lo divino).", val:"angel"},
    {t:"Sigues el corazón y la empatía humana.", val:"human"},
    {t:"Rompes la norma si sirve a tu propósito.", val:"fallen"},
    {t:"Buscas proteger a los tuyos, cueste lo que cueste.", val:"nefilim"},
    {t:"Evalúas ventaja y supervivencia primero.", val:"cambion"},
    {t:"Pienso en lo que mis experiencias pasadas indican.", val:"reinc"}
  ]},
  {id:"q2", text:"Relación con la autoridad:", choices:[
    {t:"Obedecer y mantener el orden.", val:"order"},
    {t:"Cuestionar y reformar.", val:"question"},
    {t:"Liderar desde la responsabilidad.", val:"lead"},
    {t:"Rebelarse por libertad.", val:"rebel"},
    {t:"Neutral / pragmático.", val:"neutral"}
  ]},
  {id:"q3", text:"Tu fuerza principal es:", choices:[
    {t:"Compasión y guía.", val:"compassion"},
    {t:"Memoria profunda y sabiduría.", val:"memory"},
    {t:"Claridad y juicio.", val:"clarity"},
    {t:"Astucia y estrategia.", val:"cunning"},
    {t:"Fuerza bruta / presencia.", val:"power"}
  ]},
  {id:"q4", text:"Luz o sombra:", choices:[
    {t:"Luz (claridad, orden).", val:"light"},
    {t:"Sombra (oculto, transformación).", val:"shadow"},
    {t:"Ambos, según necesidad.", val:"both"},
    {t:"Flux: cambia con las eras.", val:"flux"}
  ]},
  {id:"q5", text:"¿Sientes que has vivido antes?", choices:[
    {t:"Sí, con claridad.", val:"yes"},
    {t:"No, esta es mi primera vida.", val:"no"},
    {t:"A veces, recuerdos fragmentados.", val:"vague"}
  ]},
  {id:"q6", text:"Prefieres:", choices:[
    {t:"Enseñar y guiar (maestro).", val:"teach"},
    {t:"Aprender (discípulo).", val:"learn"},
    {t:"Actuar sola(o) / independiente.", val:"solo"}
  ]},
  {id:"q7", text:"Elemento con el que más te identificas:", choices:[
    {t:"Aire (mente, mensajería).", val:"air"},
    {t:"Agua (memoria, emociones).", val:"water"},
    {t:"Fuego (pasión, destrucción/creación).", val:"fire"},
    {t:"Tierra (cuerpo, raíces).", val:"earth"},
    {t:"Espíritu (algo más allá).", val:"spirit"}
  ]},
  {id:"q8", text:"¿Cómo resuelves un conflicto?", choices:[
    {t:"Negociando.", val:"negotiate"},
    {t:"Por astucia.", val:"outsmart"},
    {t:"Con fuerza.", val:"fight"},
    {t:"Absorbiendo y transformando.", val:"absorb"},
    {t:"Exiliando / separando.", val:"exile"}
  ]},
  {id:"q9", text:"Prioridad: ¿Orden cósmico o libertad personal?", choices:[
    {t:"Orden cósmico.", val:"cosmic"},
    {t:"Libertad personal.", val:"personal"},
    {t:"Balance.", val:"balance"}
  ]},
  {id:"q10", text:"Elige un símbolo:", choices:[
    {t:"Pluma (mensajería/ligereza).", val:"feather"},
    {t:"Cadena rota (liberación).", val:"chain"},
    {t:"Doble espada (protección).", val:"blade"},
    {t:"Raíces (vínculo con la tierra).", val:"roots"},
    {t:"Llama (poder transformador).", val:"flame"}
  ]},
  {id:"q11", text:"Hora preferida:", choices:[
    {t:"Amanecer.", val:"dawn"},
    {t:"Mediodía.", val:"noon"},
    {t:"Ocaso/crepúsculo.", val:"dusk"},
    {t:"Medianoche.", val:"midnight"}
  ]},
  {id:"q12", text:"Tu misión (elige la frase que más resuene):", choices:[
    {t:"Preservar lo sagrado y el orden.", val:"preserve"},
    {t:"Aprender y transmitir saberes.", val:"learn"},
    {t:"Romper cadenas y transformar.", val:"rebel"},
    {t:"Ser puente entre mundos.", val:"bridge"},
    {t:"Catalizar cambio radical.", val:"transform"}
  ]}
];

const QUESTIONS_CONTAINER = document.getElementById('questions');
let answers = {};

function renderQuestions(){
  QUESTIONS_CONTAINER.innerHTML = '';
  QUESTIONS.forEach((q, idx)=>{
    const qWrap = document.createElement('section');
    qWrap.className = 'question';
    qWrap.id = q.id;
    qWrap.innerHTML = `<div class="q-head"><div class="q-num">${idx+1}</div><div class="q-text">${q.text}</div></div><div class="choices" role="list"></div><div class="mini muted">Pulsa una opción para seleccionar; la pregunta se compactará y avanzará.</div>`;
    QUESTIONS_CONTAINER.appendChild(qWrap);
    const choicesEl = qWrap.querySelector('.choices');
    q.choices.forEach(opt=>{
      const btn = document.createElement('button');
      btn.className = 'choice';
      btn.type = 'button';
      btn.setAttribute('aria-pressed','false');
      btn.innerText = opt.t;
      btn.addEventListener('click', ()=> handleChoice(qWrap, q.id, opt.val, btn));
      btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); btn.click(); } });
      choicesEl.appendChild(btn);
    });
  });
  document.getElementById('total').textContent = QUESTIONS.length;
  updateProgress();
}

function handleChoice(qEl, qid, val, btn){
  if(qEl.classList.contains('answered')) return;
  answers[qid] = val;
  // mark pressed for visual feedback
  qEl.querySelectorAll('button.choice').forEach(b=>b.setAttribute('aria-pressed','false'));
  btn.setAttribute('aria-pressed','true');
  // compact question
  qEl.classList.add('answered');
  // set maxHeight to current scrollHeight then shrink for smooth transition
  qEl.style.maxHeight = qEl.scrollHeight + 'px';
  requestAnimationFrame(()=> qEl.style.maxHeight = '72px');
  updateProgress();
  // scroll to next
  setTimeout(()=>{
    const all = Array.from(document.querySelectorAll('.question'));
    const i = all.indexOf(qEl);
    if(i < all.length-1){
      all[i+1].scrollIntoView({behavior:'smooth', block:'center'});
      all[i+1].animate([{boxShadow:'0 0 0 rgba(255,210,127,0)'},{boxShadow:'0 20px 60px rgba(255,210,127,0.04)'}], {duration:420});
    } else {
      document.getElementById('reveal').focus();
    }
  }, 380);
}

function updateProgress(){
  document.getElementById('progress').textContent = Object.keys(answers).length;
}

function computeResult(){
  const tally = { angel:0, fallen:0, nefilim:0, cambion:0, human:0, reinc:0 };
  const meta = { order:0, rebel:0, light:0, dark:0, master:0, disciple:0, independent:0, memory:0, solar:0, lunar:0 };
  function add(f,n=1){ tally[f] = (tally[f]||0)+n; }

  const a = (id)=>answers[id];
  if(a('q1')==='angel'){ add('angel',2); meta.order++; }
  if(a('q1')==='human'){ add('human',2); }
  if(a('q1')==='fallen'){ add('fallen',2); meta.rebel++; }
  if(a('q1')==='nefilim'){ add('nefilim',2); }
  if(a('q1')==='cambion'){ add('cambion',2); meta.dark++; }
  if(a('q1')==='reinc'){ add('reinc',2); meta.memory++; }

  if(a('q2')==='order'){ meta.order+=2; add('angel',1); }
  if(a('q2')==='question'){ meta.rebel++; add('fallen',1); add('human',1); }
  if(a('q2')==='lead'){ add('angel',1); add('nefilim',1); meta.master++; }
  if(a('q2')==='rebel'){ add('fallen',1); add('cambion',1); meta.rebel+=2; }
  if(a('q2')==='neutral'){ add('human',1); add('reinc',1); }

  if(a('q3')==='compassion'){ add('angel',2); meta.light++; }
  if(a('q3')==='memory'){ add('reinc',2); meta.memory++; }
  if(a('q3')==='clarity'){ add('angel',1); add('human',1); meta.order++; }
  if(a('q3')==='cunning'){ add('fallen',1); add('cambion',1); meta.rebel++; }
  if(a('q3')==='power'){ add('cambion',2); add('fallen',1); meta.dark++; }

  if(a('q4')==='light'){ meta.light+=2; add('angel',1); meta.solar++; }
  if(a('q4')==='shadow'){ meta.dark+=2; add('fallen',1); meta.lunar++; }
  if(a('q4')==='both'){ add('nefilim',1); meta.order++; meta.rebel++; }
  if(a('q4')==='flux'){ add('reinc',1); add('human',1); }

  if(a('q5')==='yes'){ add('reinc',2); meta.memory+=2; }
  if(a('q5')==='no'){ add('human',1); }
  if(a('q5')==='vague'){ add('reinc',1); add('nefilim',1); }

  if(a('q6')==='teach'){ meta.master+=2; }
  if(a('q6')==='learn'){ meta.disciple+=2; }
  if(a('q6')==='solo'){ meta.independent+=2; }

  if(a('q7')==='air'){ add('angel',1); meta.solar++; }
  if(a('q7')==='water'){ add('reinc',1); meta.lunar++; }
  if(a('q7')==='fire'){ add('fallen',1); add('cambion',1); meta.dark++; meta.solar++; }
  if(a('q7')==='earth'){ add('nefilim',1); }
  if(a('q7')==='spirit'){ add('angel',1); add('reinc',1); }

  if(a('q8')==='negotiate'){ add('angel',1); add('human',1); meta.order++; }
  if(a('q8')==='outsmart'){ add('fallen',1); add('cambion',1); }
  if(a('q8')==='fight'){ add('cambion',2); add('fallen',1); }
  if(a('q8')==='absorb'){ add('nefilim',2); meta.memory++; }
  if(a('q8')==='exile'){ add('angel',1); add('fallen',1); meta.order++; }

  if(a('q9')==='cosmic'){ add('angel',2); meta.order+=2; meta.solar++; }
  if(a('q9')==='personal'){ add('cambion',1); add('human',1); meta.rebel++; meta.dark++; }
  if(a('q9')==='balance'){ add('nefilim',2); add('reinc',1); }

  if(a('q10')==='feather'){ add('angel',2); meta.light++; }
  if(a('q10')==='chain'){ add('fallen',1); add('reinc',1); }
  if(a('q10')==='blade'){ add('cambion',1); add('fallen',1); }
  if(a('q10')==='roots'){ add('nefilim',2); }
  if(a('q10')==='flame'){ add('cambion',2); add('fallen',1); meta.dark++; }

  if(a('q11')==='dawn'){ meta.solar+=2; add('angel',1); }
  if(a('q11')==='noon'){ meta.solar+=2; add('angel',1); add('human',1); }
  if(a('q11')==='dusk'){ meta.lunar+=2; add('fallen',1); add('nefilim',1); }
  if(a('q11')==='midnight'){ meta.lunar+=3; add('reinc',1); add('fallen',1); }

  if(a('q12')==='preserve'){ add('angel',2); meta.order++; }
  if(a('q12')==='learn'){ add('reinc',2); meta.memory++; }
  if(a('q12')==='rebel'){ add('fallen',2); meta.rebel+=2; }
  if(a('q12')==='bridge'){ add('nefilim',2); meta.balance=1; }
  if(a('q12')==='transform'){ add('cambion',2); meta.dark++; }

  // pick top faction
  let topFaction = null, topScore = -Infinity;
  Object.keys(tally).forEach(k=>{ if(tally[k]>topScore){ topScore=tally[k]; topFaction=k; }});

  // role
  let role = "Independiente";
  if(meta.master>meta.disciple && meta.master>=meta.independent) role="Maestro";
  if(meta.disciple>meta.master && meta.disciple>=meta.independent) role="Discípulo";
  if(meta.independent>meta.master && meta.independent>meta.disciple) role="Independiente";

  // tarot pick
  function pickTarot(f){
    if(f==='angel'){
      if(meta.order>meta.rebel) return {card:"El Sol", meaning:"claridad, guía, apoteosis espiritual"};
      if(meta.master>meta.disciple) return {card:"El Hierofante", meaning:"maestría, tradición, enseñanza divina"};
      return {card:"El Juicio", meaning:"llamado, despertar, misión trascendente"};
    }
    if(f==='fallen'){ if(meta.rebel>meta.order) return {card:"La Torre", meaning:"ruptura, revelación forzada"}; return {card:"El Colgado", meaning:"sacrificio, nueva perspectiva"}; }
    if(f==='nefilim') return {card:"La Templanza", meaning:"puente, equilibrio entre opuestos"};
    if(f==='cambion') return (meta.dark>meta.light)?{card:"El Diablo", meaning:"instintos, cadenas que dan poder y precio"}:{card:"La Muerte", meaning:"transformación radical, renacimiento por pérdida"};
    if(f==='reinc') return {card:"La Rueda de la Fortuna", meaning:"ciclos, memoria kármica, retorno"};
    if(f==='human') return {card:"El Loco", meaning:"comienzo, libertad, fe en lo desconocido"};
    return {card:"El Mago", meaning:"poder de manifestación"};
  }

  const tarot = pickTarot(topFaction);

  function determineRank(f){
    if(f==='angel'){
      const score = meta.order + meta.light + (tally['angel']||0);
      if(score>=6) return "Trono / Serafín (Rango Superior)";
      if(score>=4) return "Arcángel / Querubín (Rango Alto)";
      if(score>=2) return "Principado / Potestad (Rango Medio)";
      return "Ángel mensajero (Rango Inferior)";
    }
    if(f==='fallen'){
      const s = meta.rebel + (tally['fallen']||0);
      if(s>=5) return "Príncipe Caído / General (Rango Alto)";
      if(s>=3) return "Exiliado / Vigilante (Rango Medio)";
      return "Caído Menor (Rango Inferior)";
    }
    if(f==='nefilim'){
      const s = (tally['nefilim']||0) + meta.memory;
      if(s>=4) return "Nefelim Guardián (Rango Alto)";
      if(s>=2) return "Nefelim Protector (Rango Medio)";
      return "Nefelim Errante (Rango Inferior)";
    }
    if(f==='cambion'){
      const s = (tally['cambion']||0) + meta.dark;
      if(s>=4) return "Cambión Señor (Rango Alto)";
      if(s>=2) return "Cambión Guerrero (Rango Medio)";
      return "Cambión Huérfano (Rango Inferior)";
    }
    if(f==='reinc'){
      const s = (tally['reinc']||0) + meta.memory;
      if(s>=4) return "Alma Antigua, Maestro (Rango Alto)";
      if(s>=2) return "Alma con Recuerdos (Rango Medio)";
      return "Reencarnado Joven (Rango Inferior)";
    }
    if(f==='human'){
      const s = (tally['human']||0);
      if(s>=3) return "Humano de Gran Voluntad (Líder)";
      return "Humano Común";
    }
    return "Errante";
  }

  const rank = determineRank(topFaction || 'human');

  const descriptions = {
    angel:"Eres un ser de luz, orientado al orden y la tutela divina. Tu propósito es servir como vínculo entre lo divino y lo humano.",
    fallen:"Eres independiente, conocedor de secretos prohibidos y capacitado para cambiar el orden establecido. Tu poder suele costar un precio.",
    nefilim:"Eres puente entre lo humano y lo celestial. Posees empatía y fortaleza, y cargas con ambas naturalezas.",
    cambion:"Eres híbrido con ascendencia oscura. Instintos, supervivencia y transformación rápida son tus herramientas.",
    reinc:"Traes memorias de vidas pasadas. Tu visión es amplia y tus decisiones pesan diplomacia y lecciones anteriores.",
    human:"Eres humano: libertad, creatividad e incertidumbre. Tu valor está en elegir y aprender."
  };

  const suggestions = {
    angel:["Asiel (escriba y guardián de revelaciones)","Ereviel (ángel del ocaso)","Rauriel (luz naciente)"],
    fallen:["Semyaza","Azazel","Rauriel Oscuro (arquetipo)"],
    nefilim:["Gadreel (tradicional)","Aurielín (original)"],
    cambion:["Naamah (mitologías varias)","Cambión señor (título)"],
    reinc:["Mumiah","Raziel (maestro de secretos)","Remiel"],
    human:["— Tu nombre humano —","Guía humano interior"]
  };

  const out = document.getElementById('output');
  out.style.display='block';
  // Traducciones bonitas
const niceFactions = {
  angel: "Ángel",
  fallen: "Ángel Caído",
  nefilim: "Nefelim",
  cambion: "Cambión",
  reinc: "Alma Reencarnada",
  human: "Humano"
};

out.style.display='block';
out.innerHTML = `<h3>Resultado</h3>

    <p><strong>Facción:</strong> ${niceFactions[topFaction] || "Humano"}</p>
    <p><strong>Rango:</strong> ${rank}</p>
    <p><strong>Rol:</strong> ${role}</p>

    <p><strong>Tarot:</strong> ${tarot.card} — <em>${tarot.meaning}</em></p>

    <hr/>

    <p>${descriptions[topFaction] || descriptions['human']}</p>

    <p><strong>Nombres sugeridos:</strong> ${(suggestions[topFaction] || suggestions['human']).join(', ')}</p>
`;

    <p><strong>Rango:</strong> ${rank}</p>
    <p><strong>Rol:</strong> ${role}</p>
    <p><strong>Tarot:</strong> ${tarot.card} — <em>${tarot.meaning}</em></p>
    <hr/>
    <p>${descriptions[topFaction||'human']}</p>
    <p><strong>Nombres sugeridos:</strong> ${(suggestions[topFaction]||suggestions['human']).join(', ')}</p>
    <p class="muted small">Respuestas: ${JSON.stringify(answers)}</p>`;
  out.scrollIntoView({behavior:'smooth', block:'center'});
}

function capitalize(s){ return s? s.charAt(0).toUpperCase()+s.slice(1):''; }

document.getElementById('reveal').addEventListener('click', ()=>{
  if(Object.keys(answers).length < QUESTIONS.length){
    const all = Array.from(document.querySelectorAll('.question'));
    const firstUn = all.find(q=> !q.classList.contains('answered'));
    if(firstUn){ firstUn.scrollIntoView({behavior:'smooth', block:'center'}); firstUn.animate([{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:360}); }
    return alert('Por favor responde todas las preguntas. El test avanza automáticamente al elegir.');
  }
  computeResult();
});

document.getElementById('reset').addEventListener('click', ()=>{
  answers={};
  renderQuestions();
  document.getElementById('output').style.display='none';
  document.getElementById('progress').textContent='0';
});

function renderQuestions(){ QUESTIONS_CONTAINER.innerHTML=''; QUESTIONS.forEach((q, idx)=>{/* re-render helper in case of reset */ const qWrap=document.createElement('section'); qWrap.className='question'; qWrap.id=q.id; qWrap.innerHTML=`<div class="q-head"><div class="q-num">${idx+1}</div><div class="q-text">${q.text}</div></div><div class="choices" role="list"></div><div class="mini muted">Pulsa una opción para seleccionar; la pregunta se compactará y avanzará.</div>`; QUESTIONS_CONTAINER.appendChild(qWrap); const choicesEl=qWrap.querySelector('.choices'); q.choices.forEach(opt=>{ const btn=document.createElement('button'); btn.className='choice'; btn.type='button'; btn.setAttribute('aria-pressed','false'); btn.innerText=opt.t; btn.addEventListener('click', ()=> handleChoice(qWrap, q.id, opt.val, btn)); btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); btn.click(); } }); choicesEl.appendChild(btn); }); }); document.getElementById('total').textContent = QUESTIONS.length; updateProgress(); }

renderQuestions();
</script>
</body>
</html>

